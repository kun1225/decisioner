# G-18 Authentication and Session Security

## Goal Statement

使用者可以安全登入並維持可控的登入狀態。

## Requirement

系統必須提供帳號登入、refresh rotation、token reuse 防護與基本授權邊界。

## In Scope

1. Local register/login
2. Google idToken login
3. Access token + refresh token rotation
4. `/auth/me` session restore
5. Logout revoke

## Out Scope

1. 多因子驗證（MFA）
2. SSO enterprise federation

## Acceptance Criteria

- [ ] Given 新使用者註冊成功，When 使用者登入，Then 取得 access token 與 refresh cookie。
- [ ] Given access token 過期，When 呼叫 refresh，Then 舊 refresh token 被撤銷並簽發新 token。
- [ ] Given 偵測到 revoked refresh token reuse，When 服務處理該請求，Then 同 family token 被撤銷並要求重新登入。
- [ ] Given 使用者呼叫 logout，When 完成登出，Then refresh token 不可再用於換發。
